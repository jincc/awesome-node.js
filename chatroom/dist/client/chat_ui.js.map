{"version":3,"sources":["../../libs/client/chat_ui.js"],"names":["divEscapedContentElement","message","$","text","divSystemContentElement","html","processUserInput","chatApp","socket","val","systemMessage","chart","processCommand","append","sendMessage","scrollTop","prop","io","connect","document","ready","Chat","on","result","success","name","room","newElement","rooms","empty","substring","length","click","focus","setInterval","emit","submit"],"mappings":"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","file":"chat_ui.js","sourcesContent":["function divEscapedContentElement(message){\n    return $('<div></div>').text(message)\n}\n\nfunction divSystemContentElement(message){\n    return $('<div></div>').html('<i>'+ message + '</i>')\n}\n\nfunction processUserInput(chatApp,socket){\n    var message = $('#send-message').val()\n    var systemMessage \n    if (message.chart(0) == '/') {\n        systemMessage = chatApp.processCommand(message)\n        if (systemMessage){\n            $('#messages').append(divSystemContentElement(systemMessage))\n        }\n    }else{\n        chatApp.sendMessage($('#room').text(),message)\n        $('#messages').append(divEscapedContentElement(message))\n        $('#messages').scrollTop($('#messages').prop('scrollHeight'))\n    }\n    $('#send-message').val('')\n}\n\nvar socket = io.connect();\n\n$(document).ready(function() {\n  var chatApp = new Chat(socket);\n\n  socket.on('nameResult', function(result) {\n    var message;\n\n    if (result.success) {\n      message = 'You are now known as ' + result.name + '.';\n    } else {\n      message = result.message;\n    }\n    $('#messages').append(divSystemContentElement(message));\n  });\n\n  socket.on('joinResult', function(result) {\n    $('#room').text(result.room);\n    $('#messages').append(divSystemContentElement('Room changed.'));\n  });\n\n  socket.on('message', function (message) {\n    var newElement = $('<div></div>').text(message.text);\n    $('#messages').append(newElement);\n  });\n\n  socket.on('rooms', function(rooms) {\n    $('#room-list').empty();\n\n    for(var room in rooms) {\n      room = room.substring(1, room.length);\n      if (room != '') {\n        $('#room-list').append(divEscapedContentElement(room));\n      }\n    }\n\n    $('#room-list div').click(function() {\n      chatApp.processCommand('/join ' + $(this).text());\n      $('#send-message').focus();\n    });\n  });\n\n  setInterval(function() {\n    socket.emit('rooms');\n  }, 1000);\n\n  $('#send-message').focus();\n\n  $('#send-form').submit(function() {\n    processUserInput(chatApp, socket);\n    return false;\n  });\n});\n"]}